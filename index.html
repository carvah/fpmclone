<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Clone of Gabriel Gabmetta's Fast-Paced Multiplayer demo</title>
    <style>
        canvas {
            border: dotted 1px;
            padding:0;
            background: lightgray;
        }

        .lag {
            width: 50px;
        }

        #server .tickRate {
            width: 50px;
        }
    </style>
</head>
<body>
    <h1>Multiplayer client/server demo</h1>
    <p>Clone of <a href="http://www.gabrielgambetta.com/fpm_live.html">Gabriel
    Gambetta's original demo</a>, adding entity interpolation.  His series of
    articles explaining <a
    href="http://www.gabrielgambetta.com/fast_paced_multiplayer.html">Fast-Paced
    Multiplayer games</a> is an excellent read, and essential to understanding
    this.  Writeup <a href="#discussion">below</a>.</p>


    <h2>Game views</h2>

    <div id="p1">
        <h3>Player 1 (move with: q, e)</h3>
        <label> Lag <input class="lag" type="text" value="250"> ms</label> /
        <label><input class="prediction" type="checkbox"> prediction</label> /
        <label><input class="reconciliation" type="checkbox"> reconciliation</label> /
        <label><input class="entity-interpolation" type="checkbox"> entity interpolation</label>
        <br>
        <canvas width=960 height=100></canvas>
        <div class="status">Non-ackd inputs: <span class="non-ackd">0</span></div>
    </div>

    <div id="p2">
        <h3>Player 2 (move with: a, d)</h3>
        <label> Lag <input class="lag" type="text" value="250"> ms</label> /
        <label><input class="prediction" type="checkbox" checked> prediction</label> /
        <label><input class="reconciliation" type="checkbox"> reconciliation</label> /
        <label><input class="entity-interpolation" type="checkbox"> entity interpolation</label>
        <br>
        <canvas width=960 height=100></canvas>
        <div class="status">Non-ackd inputs: <span class="non-ackd">0</span></div>
    </div>

    <div id="p3">
        <h3>Player 3 (move with: z, c)</h3>
        <label> Lag <input class="lag" type="text" value="250"> ms</label> /
        <label><input class="prediction" type="checkbox" checked> prediction</label> /
        <label><input class="reconciliation" type="checkbox" checked> reconciliation</label> /
        <label><input class="entity-interpolation" type="checkbox" checked> entity interpolation</label>
        <br>
        <canvas width=960 height=100></canvas>
        <div class="status">Non-ackd inputs: <span class="non-ackd">0</span></div>
    </div>

    <br>
    <hr>

    <div id="server">
        <h3>Server</h3>
        <label>Update rate (aka tick rate): <input class="tickRate" type="text" value="1"> per second</label>
        <br>
        <canvas id="serverCanvas" width=960 height=100></canvas>
    </div>

    <h2 id="discussion">Discussion</h2>

    <p>I made this in order to better understand the concepts shown in
    the original, and to learn about developing TypeScript projects.</p>

    <p>TODO: add something to demonstrate lag compensation.</p>

    <h2>Things to try</h2>

    <p>Move player 3 (e.g. hold down 'c' or 'z'). Note how smoothly the player
    3 view renders.  Now move player 1 or player 2 the same way and note how
    slow or jumpy they are.  This shows the effect of client prediction and
    input reconciliation. (Same as Gabriel's original demo.)</p>

    <p>With default settings, move player 1 (e.g. hold down 'e') and observe
    player 3's view compared to other players.  This is entity interpolation
    at work.  All players are receiving world updates only once a second, but
    player 3 renders player 1's position smoothly.</p>

    <p>Check out the recommendations for things to try in the <a
    href="http://www.gabrielgambetta.com/fpm_live.html">original demo</a>.</p>

    <script src="./dist/bundle.js"></script>
</body>
</html>

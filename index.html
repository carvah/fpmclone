<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Clone of Gabriel Gabmetta's Fast-Paced Multiplayer demo</title>
    <style>
        canvas {
            border: dotted 1px;
            padding:0;
            background: lightgray;
        }

        .lag {
            width: 50px;
        }

        #server .tickRate {
            width: 50px;
        }
    </style>
</head>
<body>
    <h1>Multiplayer client/server demo (<a href="https://github.com/overthink/fpmclone">source</a>)</h1>

    <p>Clone of <a href="http://www.gabrielgambetta.com/fpm_live.html">Gabriel
    Gambetta's original demo</a>, adding entity interpolation.  I made this in
    order to better understand the original, and to learn about developing
    TypeScript projects.  His series of articles explaining <a
    href="http://www.gabrielgambetta.com/fast_paced_multiplayer.html">Fast-Paced
    Multiplayer games</a> is an excellent read, and essential to understanding
    this.</p>

    <p>Disclaimer: I'm not a game developer, and this is the first gamey thing
    I've tried, so beware of the code.</p>

    <p>Writeup <a href="#discussion">below</a> with ideas to try out with this.</p>

    <hr>

    <h2>Game views</h2>

    <div id="p1">
        <h3>Player 1 (move with: q, e)</h3>
        <label> Lag <input class="lag" type="text" value="250"> ms</label> /
        <label><input class="prediction" type="checkbox"> prediction</label> /
        <label><input class="reconciliation" type="checkbox"> reconciliation</label> /
        <label><input class="entity-interpolation" type="checkbox"> entity interpolation</label>
        <br>
        <canvas width=960 height=100></canvas>
        <div class="status">Non-ackd inputs: <span class="non-ackd">0</span></div>
    </div>

    <div id="p2">
        <h3>Player 2 (move with: a, d)</h3>
        <label> Lag <input class="lag" type="text" value="250"> ms</label> /
        <label><input class="prediction" type="checkbox" checked> prediction</label> /
        <label><input class="reconciliation" type="checkbox"> reconciliation</label> /
        <label><input class="entity-interpolation" type="checkbox"> entity interpolation</label>
        <br>
        <canvas width=960 height=100></canvas>
        <div class="status">Non-ackd inputs: <span class="non-ackd">0</span></div>
    </div>

    <div id="p3">
        <h3>Player 3 (move with: z, c)</h3>
        <label> Lag <input class="lag" type="text" value="250"> ms</label> /
        <label><input class="prediction" type="checkbox" checked> prediction</label> /
        <label><input class="reconciliation" type="checkbox" checked> reconciliation</label> /
        <label><input class="entity-interpolation" type="checkbox" checked> entity interpolation</label>
        <br>
        <canvas width=960 height=100></canvas>
        <div class="status">Non-ackd inputs: <span class="non-ackd">0</span></div>
    </div>

    <br>

    <div id="server">
        <h3>Server (autoritative state)</h3>
        <label>Update rate (aka tick rate): <input class="tickRate" type="text" value="1"> per second</label>
        <br>
        <canvas id="serverCanvas" width=960 height=100></canvas>
    </div>

    <h2 id="discussion">Things to try</h2>

    <p>With default settings, move player 3 around. Note how smoothly player
    3's view renders.  Now move player 1 or player 2 the same way and note how
    slow or jumpy their views update.  This shows the effect of client
    prediction and input reconciliation. (Same as Gabriel's original
    demo.)</p>

    <p>Now observe player 3's view as you move player 1 a& 2 around.  Note how
    players  1 and 2 move smoothly -- but delayed -- compared to everyone
    else's view.  This is entity interpolation at work.</p>

    <p>Turn entity interpolation on for all players, but give player 1 and 2
    very different lag values (say 2000 ms, and 20ms).  Then move player 3
    around and observe how the other players see the state of the world.  Note
    how the high-lag player's view of the world is considerably delayed, but
    still smooth.</p>

    <p>Check out the recommendations for things to try in the <a
    href="http://www.gabrielgambetta.com/fpm_live.html">original demo</a>.</p>

    <p>TODO: add something to demonstrate lag compensation, the remaining
    concept from the article series that is not demonstrated.</p>

    <script src="./dist/bundle.js"></script>
</body>
</html>
